



<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Aggregation Mechanism &mdash; DIAS-Documentation 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Changing of states" href="change.states.html" />
    <link rel="prev" title="Conceptual Architecture" href="conceptual.architecture.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> DIAS-Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../pre.requisites.html">Pre-requisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../dias.in.detail.html">How DIAS Works</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="conceptual.architecture.html">Conceptual Architecture</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Aggregation Mechanism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#case-1">Case 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-2">Case 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-3">Case 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-4">Case 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-5">Case 5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-6">Case 6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-7">Case 7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-8">Case 8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-8-1">Case 8.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-8-2">Case 8.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-8-3">Case 8.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-8-4">Case 8.4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-8-5">Case 8.5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-9">Case 9</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-10">Case 10</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-11">Case 11</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-12">Case 12</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-13">Case 13</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-14">Case 14</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-15">Case 15</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-16">Case 16</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-17">Case 17</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-18">Case 18</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-19">Case 19</a></li>
<li class="toctree-l3"><a class="reference internal" href="#case-20">Case 20</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="change.states.html">Changing of states</a></li>
<li class="toctree-l2"><a class="reference internal" href="join.and.leave.html">Join and Leave</a></li>
<li class="toctree-l2"><a class="reference internal" href="Carrier.peer.html">Carrier Peer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Deployment Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protopeer.html">Protopeer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dias-logging-system.html">DIAS Logging System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DIAS-Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../dias.in.detail.html">How DIAS Works</a> &raquo;</li>
        
      <li>Aggregation Mechanism</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/sections/dias.in.detail/aggregation.mechanism.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aggregation-mechanism">
<h1>Aggregation Mechanism<a class="headerlink" href="#aggregation-mechanism" title="Permalink to this headline">¶</a></h1>
<div class="section" id="case-1">
<h2>Case 1<a class="headerlink" href="#case-1" title="Permalink to this headline">¶</a></h2>
<p>Conditions:</p>
<blockquote>
<div><ul class="simple">
<li><p>Both peers have communicated before</p></li>
<li><p>Thus positiveAMD and positiveDMA are both true</p></li>
</ul>
</div></blockquote>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Level 1.1: Check for false positives in the positive AMS memberships</span>
    <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">posAMS</span> <span class="o">=</span> <span class="p">(</span><span class="n">HashSet</span><span class="p">)</span> <span class="n">disseminatorReport</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">DisseminatorReport</span><span class="p">.</span><span class="na">POSITIVE_AMS</span><span class="p">);</span>
    <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">it</span> <span class="o">=</span> <span class="n">posAMS</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
    <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span> <span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;1. CURRENT STATE { &quot;</span> <span class="o">+</span>
          <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA =    &quot;</span> <span class="o">+</span> <span class="n">positiveDMA</span>   <span class="o">+</span>
          <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() =  &quot;</span> <span class="o">+</span> <span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">+</span>
          <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span> <span class="s">&quot; }&quot;</span><span class="p">);</span>

    <span class="k">while</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="na">hasNext</span><span class="p">()){</span>
      <span class="n">State</span> <span class="n">state</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">()))</span> <span class="p">{</span>
          <span class="n">tobeRemoved</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">it</span><span class="p">.</span><span class="na">remove</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;REMOVED STATE: &quot;</span> <span class="o">+</span> <span class="n">state</span> <span class="o">+</span> <span class="s">&quot;, NEW STATE IS: &quot;</span> <span class="o">+</span> <span class="n">newState</span> <span class="o">+</span> <span class="s">&quot;, SMA contains new state: &quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">()));</span>
      <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 12</p></td>
<td><p>Iterate on all the states that the “sending peer” thinks that I’m using</p></td>
</tr>
<tr class="row-even"><td><p>line 14</p></td>
<td><p>| 2. Disagree! I am not using this state in my aggregate</p></td>
</tr>
<tr class="row-odd"><td><p>line 19</p></td>
<td><div class="line-block">
<div class="line">This will set th AMSRemoval field in the PULL message returned to the</div>
<div class="line">“sending peer” in order to update his own AMSs so that the sending peer</div>
<div class="line">can remove this state for this peer Dissemeniot:receiveAggregatorReport</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">SMA[posAMS] = false</div>
<div class="line">SMA[selected_state] = true</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-2">
<h2>Case 2<a class="headerlink" href="#case-2" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">State</span> <span class="n">oldState</span> <span class="o">=</span> <span class="n">posAMS</span><span class="p">.</span><span class="na">iterator</span><span class="p">().</span><span class="na">next</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">shouldRemove</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">oldState</span><span class="p">;</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">removed</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">oldState</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">removed</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">possibles</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
          <span class="kt">boolean</span> <span class="n">a</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="k">while</span><span class="p">(</span><span class="n">iterator</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">State</span> <span class="n">state</span> <span class="o">=</span> <span class="n">iterator</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
            <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">state</span><span class="p">))</span> <span class="p">{</span>
              <span class="k">this</span><span class="p">.</span><span class="na">removeAggregationState</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
              <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
              <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">REMOVAL</span><span class="p">;</span>
              <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
              <span class="n">a</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
              <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;#####################&quot;</span><span class="p">);</span>
              <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;2&quot;</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;2. CURRENT STATE { &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; positiveAMD = &quot;</span>         <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
                  <span class="s">&quot; | shouldRemove = &quot;</span>      <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot; 1 &quot;</span>       <span class="o">+</span>
                  <span class="s">&quot; | purpose = &quot;</span>           <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span> <span class="s">&quot; | removed = &quot;</span>       <span class="o">+</span> <span class="n">removed</span>     <span class="o">+</span>
                  <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; | NOTHING REMOVED }&quot;</span><span class="p">);</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><p>| 1. Peers have communicated before (start time = Big Bang)</p></td>
</tr>
<tr class="row-odd"><td><p>line 3</p></td>
<td><p>| 2. Only a single state in the list of all states that the sending peers think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 6</p></td>
<td><p>| 3. Other peer thinks we should remove it (recall that there is only 1) strategy = REMOVAL</p></td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>Try to remove it</p></td>
</tr>
<tr class="row-even"><td><p>line 10</p></td>
<td><p>Didn’t find the state to be removed in my SMAs</p></td>
</tr>
<tr class="row-odd"><td><p>line 14</p></td>
<td><p>Iterate throug all possible states of the sending peer</p></td>
</tr>
<tr class="row-even"><td><p>line 17</p></td>
<td><p>Remove it from the SMA</p></td>
</tr>
<tr class="row-odd"><td><p>line 19</p></td>
<td><div class="line-block">
<div class="line">This will set th AMSRemoval field in the PULL message returned to the “sending peer”</div>
<div class="line">in order to update his own AMSs so that the sending peer can remove this state for</div>
<div class="line">for this peer Dissemeniot:receiveAggregatorReport</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:1</div>
<div class="line">purpose:REMOVAL*</div>
<div class="line">SMA[posAMS] = false</div>
<div class="line">POS <sup>1</sup>: <em>not null</em></div>
<div class="line">SMA[selected_state] <sup>2</sup> = true</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:true</div>
<div class="line">1 POS: possible states of the sending peer</div>
<div class="line">2 SMA[POS]: SMA contains one state from the possible states of the sending peer</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-3">
<h2>Case 3<a class="headerlink" href="#case-3" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">State</span> <span class="n">oldState</span> <span class="o">=</span> <span class="n">posAMS</span><span class="p">.</span><span class="na">iterator</span><span class="p">().</span><span class="na">next</span><span class="p">();</span>
      <span class="k">if</span><span class="p">(</span><span class="n">shouldRemove</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">oldState</span><span class="p">;</span>
        <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kt">boolean</span> <span class="n">removed</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">oldState</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">removed</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// not executed in this case, omitted here</span>
          <span class="p">}</span> <span class="k">else</span>
          <span class="p">{</span>
            <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;3&quot;</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;3. CURRENT STATE { &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; positiveAMD = &quot;</span>         <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
                  <span class="s">&quot; | shouldRemove = &quot;</span>      <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot; 1 &quot;</span>       <span class="o">+</span>
                  <span class="s">&quot; | purpose = &quot;</span>           <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span> <span class="s">&quot; | removed = &quot;</span>       <span class="o">+</span> <span class="n">removed</span>     <span class="o">+</span>
                  <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; | NOTHING REMOVED }&quot;</span><span class="p">);</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 3</p></td>
<td><p>| 2. Only a single state in the list of all states that the sending peers think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 6</p></td>
<td><div class="line-block">
<div class="line">3. Other peer thinks we should remove it (recall that there is only 1) strategy = REMOVAL</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>Try to remove it</p></td>
</tr>
<tr class="row-even"><td><p>line 10</p></td>
<td><p>Oups! Didn’t find the state to be removed in my SMAs!</p></td>
</tr>
<tr class="row-odd"><td><p>line 11</p></td>
<td><p>Sending peer has no possible states (Just to avoid null pointer exceptions)</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:1</div>
<div class="line">purpose:REMOVAL*</div>
<div class="line">SMA[posAMS] = false</div>
<div class="line">POS <sup>1</sup>: <em>null</em></div>
<div class="line">SMA[selected_state] <sup>2</sup> = true</div>
</div>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:true</div>
<div class="line">1 POS: possible states of the sending peer</div>
<div class="line">2 SMA[POS]: SMA contains one state from the possible states of the sending peer</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="case-4">
<h2>Case 4<a class="headerlink" href="#case-4" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">State</span> <span class="n">oldState</span> <span class="o">=</span> <span class="n">posAMS</span><span class="p">.</span><span class="na">iterator</span><span class="p">().</span><span class="na">next</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">shouldRemove</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">oldState</span><span class="p">;</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">removed</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">oldState</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">removed</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Not executed in case 4, omitted</span>
      <span class="p">}</span> <span class="k">else</span>
      <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">removeAggregationState</span><span class="p">(</span><span class="n">oldState</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;4&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;4. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>         <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span>      <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot; 1 &quot;</span>       <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>           <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span> <span class="s">&quot; | removed = &quot;</span>       <span class="o">+</span> <span class="n">removed</span>     <span class="o">+</span>
              <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; | OUTCOME = REMOVAL }&quot;</span><span class="p">);</span>
        <span class="n">outcome</span><span class="o">=</span><span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">REMOVAL</span><span class="p">;</span>
        <span class="n">ack</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 3</p></td>
<td><p>| 2. Only a single state in the list of all states that the sending peers think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 6</p></td>
<td><p>| 3. Other peer thinks we should remove it (recall that there is only 1) strategy = REMOVAL</p></td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>Try to remove it</p></td>
</tr>
<tr class="row-even"><td><p>line 12</p></td>
<td><p>Successfully removed it</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:1</div>
<div class="line">purpose:REMOVAL*</div>
<div class="line">SMA[posAMS] = false</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:true</div>
<div class="line">1 POS: possible states of the sending peer</div>
<div class="line">2 SMA[POS]: SMA contains one state from the possible states of the sending peer</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-5">
<h2>Case 5<a class="headerlink" href="#case-5" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">State</span> <span class="n">oldState</span><span class="o">=</span><span class="n">posAMS</span><span class="p">.</span><span class="na">iterator</span><span class="p">().</span><span class="na">next</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">shouldRemove</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// not executed in case 5, omitted</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">oldState</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">newState</span><span class="p">))</span>
      <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>
        <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">oldState</span><span class="p">;</span>
        <span class="kt">boolean</span> <span class="n">s1</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">oldState</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">removeAggregationState</span><span class="p">(</span><span class="n">oldState</span><span class="p">);</span>
        <span class="kt">double</span> <span class="n">count1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>
        <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
        <span class="kt">boolean</span> <span class="n">s2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">addSMAMembership</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">addAggregationState</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>
        <span class="kt">double</span> <span class="n">count2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;5&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;5. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>              <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>                <span class="o">+</span> <span class="n">positiveDMA</span>               <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span>           <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>              <span class="o">+</span> <span class="s">&quot; 1 &quot;</span>                     <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>                <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | old.State.equals(newState) = &quot;</span> <span class="o">+</span> <span class="n">oldState</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">newState</span><span class="p">)</span> <span class="o">+</span>
              <span class="s">&quot; | removeOldSMAMembership = &quot;</span> <span class="o">+</span> <span class="n">s1</span>               <span class="o">+</span> <span class="s">&quot; | addNewSMAMembership = &quot;</span>        <span class="o">+</span> <span class="n">s2</span>                        <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>                 <span class="o">+</span> <span class="n">count0</span>           <span class="o">+</span> <span class="s">&quot; | count1 = &quot;</span>                     <span class="o">+</span> <span class="n">count1</span>                    <span class="o">+</span>
              <span class="s">&quot; | count2 = &quot;</span>                 <span class="o">+</span> <span class="n">count2</span>           <span class="o">+</span>
              <span class="s">&quot; | OUTCOME = UPDATE }&quot;</span><span class="p">);</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">REPLACE</span><span class="p">;</span>
        <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><p>| 1. Peers have communicated before (start time = Big Bang)</p></td>
</tr>
<tr class="row-odd"><td><p>line 3</p></td>
<td><p>| 2. Only a single state in the list of all states that the sending peers think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Other peer thinks we should EXPLOIT it (recall that there is only 1 state in posAMS)</p></td>
</tr>
<tr class="row-odd"><td><p>line 11</p></td>
<td><p>posAMS[0] != new selected state</p></td>
</tr>
<tr class="row-even"><td><p>line 16 - 20</p></td>
<td><p>Replace the old selected state with the new one</p></td>
</tr>
<tr class="row-odd"><td><p>line 32</p></td>
<td><p>Successfully replaced it</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:1</div>
<div class="line">purpose:EXPLOITATION*</div>
<div class="line">posAMS[0] != SELECTED_STATE</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-6">
<h2>Case 6<a class="headerlink" href="#case-6" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">State</span> <span class="n">oldState</span> <span class="o">=</span> <span class="n">posAMS</span><span class="p">.</span><span class="na">iterator</span><span class="p">().</span><span class="na">next</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">shouldRemove</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Not executed in case 6, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">oldState</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">newState</span><span class="p">)){</span>
        <span class="c1">// Not executed int case 6, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="k">try</span><span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">updateMaxMin</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">StateException</span> <span class="n">ex</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="n">RawLog</span><span class="p">.</span><span class="na">print</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ex</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span> <span class="o">+</span> <span class="n">ex</span><span class="p">.</span><span class="na">getStateExcMsg</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;6&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;6. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>                <span class="o">+</span> <span class="n">positiveDMA</span>               <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>              <span class="o">+</span> <span class="s">&quot; 1 &quot;</span>                     <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | old.State.equals(newState) = &quot;</span> <span class="o">+</span> <span class="n">oldState</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">newState</span><span class="p">)</span> <span class="o">+</span>
              <span class="s">&quot; | OUTCOME = DOUBLE }&quot;</span><span class="p">);</span>
        <span class="n">outcome</span><span class="o">=</span><span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">;</span>
        <span class="n">ack</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><p>| 1. Peers have communicated before (start time = Big Bang)</p></td>
</tr>
<tr class="row-odd"><td><p>line 3</p></td>
<td><p>| 2. Only a single state in the list of all states that the sending peers think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Other peer thinks we should EXPLOIT it (recall that there is only 1 state in posAMS)</p></td>
</tr>
<tr class="row-odd"><td><p>line 11</p></td>
<td><p>posAMS[0] != new selected state
(in case 6, this is not true -&gt; old = new)</p></td>
</tr>
<tr class="row-even"><td><p>line 14 - 32</p></td>
<td><p>Do nothing</p></td>
</tr>
<tr class="row-odd"><td><p>line 29</p></td>
<td><p>Successfully replaced (since we had nothing to do)</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:1</div>
<div class="line">purpose:EXPLOITATION*</div>
<div class="line">posAMS[0] != SELECTED_STATE</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-7">
<h2>Case 7<a class="headerlink" href="#case-7" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 7, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
      <span class="k">if</span><span class="p">(</span><span class="n">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">;</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;7&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;7. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>            <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>          <span class="o">+</span> <span class="s">&quot; 0 &quot;</span>       <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | SMA.contains(newState) = &quot;</span> <span class="o">+</span> <span class="n">bool</span>        <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>       <span class="o">+</span> <span class="n">count0</span>           <span class="o">+</span>
              <span class="s">&quot; | OUTCOME = DUPLICATE }&quot;</span><span class="p">);</span>

        <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
        <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">tobeRemoved</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span> <span class="p">{</span>
          <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">tobeRemoved</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Sending peer sends an EXPLOITATION</p></td>
</tr>
<tr class="row-odd"><td><p>line 14</p></td>
<td><p>New selected state is already in our aggregation</p></td>
</tr>
<tr class="row-even"><td><p>line 29 - 31</p></td>
<td><p>Jovan and Edward are still unclear why this code is here</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:EXPLOITATION*</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-8">
<h2>Case 8<a class="headerlink" href="#case-8" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 8, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
      <span class="k">if</span><span class="p">(</span><span class="n">bool</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 8, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>            <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>          <span class="o">+</span> <span class="s">&quot;0 &quot;</span>        <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | SMA.contains(newState) = &quot;</span> <span class="o">+</span> <span class="n">bool</span>        <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>       <span class="o">+</span> <span class="n">count0</span>           <span class="o">+</span>
              <span class="s">&quot; | NOT INCONSISTENCY ANYMORE }&quot;</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">possibles</span><span class="p">.</span><span class="na">iterator</span><span class="p">();</span>
          <span class="kt">boolean</span> <span class="n">found</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="n">State</span> <span class="n">state</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
          <span class="k">while</span><span class="p">(</span><span class="n">iterator</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">iterator</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
            <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">state</span><span class="p">))</span> <span class="p">{</span>
              <span class="k">this</span><span class="p">.</span><span class="na">removeAggregationState</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
              <span class="n">found</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="kt">double</span> <span class="n">count1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Sending peer did not send a REMOVAL (this is the correct way of interpreting this flag)</p></td>
</tr>
<tr class="row-odd"><td><p>line 18</p></td>
<td><p>| 4. New selected state is NOT in our aggregation</p></td>
</tr>
<tr class="row-even"><td><p>line 29</p></td>
<td><p>| 5. Sending peer sent it’s possible states</p></td>
</tr>
<tr class="row-odd"><td><p>line 33 - 39</p></td>
<td><p><strong>To be safe</strong>, remove all possible states of the sending peer from our
Aggregator</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:EXPLOITATION*</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-8-1">
<h2>Case 8.1<a class="headerlink" href="#case-8-1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 8.1, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
      <span class="k">if</span><span class="p">(</span><span class="n">bool</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 8.1, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>            <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>          <span class="o">+</span> <span class="s">&quot;0 &quot;</span>        <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | SMA.contains(newState) = &quot;</span> <span class="o">+</span>  <span class="n">bool</span>       <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>       <span class="o">+</span> <span class="n">count0</span>           <span class="o">+</span>
              <span class="s">&quot; | NOT INCONSISTENCY ANYMORE }&quot;</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>

          <span class="c1">//**************************************************************//</span>
          <span class="c1">//                                                              //</span>
          <span class="c1">//  code for removal of all possible states here (see Case 8)   //</span>
          <span class="c1">//                                                              //</span>
          <span class="c1">//**************************************************************//</span>

          <span class="k">if</span><span class="p">(</span><span class="n">found</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8.1&quot;</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8.1. CURRENT STATE { &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; positiveAMD = &quot;</span>         <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
                  <span class="s">&quot; | shouldRemove = &quot;</span>      <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot; 0 &quot;</span>       <span class="o">+</span>
                  <span class="s">&quot; | purpose = &quot;</span>           <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span>
                  <span class="s">&quot; | count1 = &quot;</span>            <span class="o">+</span> <span class="n">count1</span>            <span class="o">+</span>
                  <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; | NOTHING REMOVED }&quot;</span><span class="p">);</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><div class="line-block">
<div class="line">2. No entries in the list of states that the sending peer think that we have</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Sending peer sends an EXPLOITATION</p></td>
</tr>
<tr class="row-odd"><td><p>line 18</p></td>
<td><p>| 4. New selected state is NOT in our aggregation</p></td>
</tr>
<tr class="row-even"><td><p>line 29</p></td>
<td><p>| 5. Sending peer sent it’s possible states</p></td>
</tr>
<tr class="row-odd"><td><p>line 33</p></td>
<td><p>Remove all possible states of the sending peer from our aggregator</p></td>
</tr>
<tr class="row-even"><td><p>line 37</p></td>
<td><p>None of the possible states were found in our aggregator</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:EXPLOITATION*</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-8-2">
<h2>Case 8.2<a class="headerlink" href="#case-8-2" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 8.2, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
      <span class="k">if</span><span class="p">(</span><span class="n">bool</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 8.2, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>        <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>            <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>       <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>          <span class="o">+</span> <span class="s">&quot;0 &quot;</span>        <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span>   <span class="o">+</span> <span class="s">&quot; | SMA.contains(newState) = &quot;</span> <span class="o">+</span>  <span class="n">bool</span>       <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>       <span class="o">+</span> <span class="n">count0</span>             <span class="o">+</span>
              <span class="s">&quot; | NOT INCONSISTENCY ANYMORE }&quot;</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>

          <span class="c1">//**************************************************************//</span>
          <span class="c1">//                                                              //</span>
          <span class="c1">//  code for removal of all possible states here (see Case 8)   //</span>
          <span class="c1">//                                                              //</span>
          <span class="c1">//**************************************************************//</span>

          <span class="k">if</span><span class="p">(</span><span class="n">found</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="c1">// Not executed int Case 8.2, omitted here</span>
          <span class="p">}</span>
          <span class="k">else</span>
          <span class="p">{</span>
            <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8.2&quot;</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8.2. CURRENT STATE { &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; positiveAMD = &quot;</span>          <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
                  <span class="s">&quot; | shouldRemove = &quot;</span>       <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot; 0 &quot;</span>       <span class="o">+</span>
                  <span class="s">&quot; | purpose = &quot;</span>            <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span>
                  <span class="s">&quot; | count1 = &quot;</span>             <span class="o">+</span> <span class="n">count1</span>            <span class="o">+</span>
                  <span class="s">&quot; | possibles == null ? &quot;</span>  <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; | STATES REMOVED FROM SMA }&quot;</span><span class="p">);</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><p>| 1. Peers have communicated before (start time = Big Bang)</p></td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Sending peer sends an EXPLOITATION</p></td>
</tr>
<tr class="row-odd"><td><p>line 18</p></td>
<td><div class="line-block">
<div class="line">4. New selected state is NOT in our aggregation</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 29</p></td>
<td><div class="line-block">
<div class="line">5. Sending peer sent it’s possible states</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 33</p></td>
<td><p>Remove all possible states of the sending peer from our aggregator</p></td>
</tr>
<tr class="row-even"><td><p>line 41</p></td>
<td><p>At least one of the possible states was found in the Aggregator</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:EXPLOITATION*</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-8-3">
<h2>Case 8.3<a class="headerlink" href="#case-8-3" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 8.3, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
      <span class="k">if</span><span class="p">(</span><span class="n">bool</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 8.3, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>            <span class="o">+</span> <span class="n">positiveDMA</span>   <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>          <span class="o">+</span> <span class="s">&quot;0 &quot;</span>          <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | SMA.contains(newState) = &quot;</span> <span class="o">+</span> <span class="n">bool</span>          <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>       <span class="o">+</span> <span class="n">count0</span>           <span class="o">+</span>
              <span class="s">&quot; | NOT INCONSISTENCY ANYMORE }&quot;</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>

          <span class="c1">//************************************************************************//</span>
          <span class="c1">//                                                                        //</span>
          <span class="c1">//  code for removal of all possible states here (see cases 8.1 and 8.2)  //</span>
          <span class="c1">//                                                                        //</span>
          <span class="c1">//************************************************************************//</span>

          <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
          <span class="kt">boolean</span> <span class="n">SMAbool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">addSMAMembership</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span> <span class="c1">// returns true if the selected state membership is added in the SMA bloom filter</span>
          <span class="k">if</span><span class="p">(</span><span class="n">SMAbool</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">addAggregationState</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">FIRST</span><span class="p">;</span>
            <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8.3&quot;</span> <span class="p">);</span>

            <span class="kt">double</span> <span class="n">count2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8.3. CURRENT STATE { &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; positiveAMD = &quot;</span>         <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span>   <span class="s">&quot; | positiveDMA = &quot;</span>                 <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
                  <span class="s">&quot; | shouldRemove = &quot;</span>      <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span>   <span class="s">&quot; | posAMS.size() = &quot;</span>               <span class="o">+</span> <span class="s">&quot; 0 &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; | purpose = &quot;</span>           <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span>   <span class="s">&quot; | addSMAMembership(newState) = &quot;</span>  <span class="o">+</span> <span class="n">SMAbool</span>  <span class="o">+</span>
                  <span class="s">&quot; | count2 = &quot;</span>            <span class="o">+</span> <span class="n">count2</span>            <span class="o">+</span>
                  <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span>   <span class="s">&quot; | OUTCOME = EXPLOITATION }&quot;</span><span class="p">);</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><p>| 1. Peers have communicated before (start time = Big Bang)</p></td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Sending peer sends an EXPLOITATION</p></td>
</tr>
<tr class="row-odd"><td><p>line 18</p></td>
<td><p>| 4. New selected state is NOT in our aggregation</p></td>
</tr>
<tr class="row-even"><td><p>line 29</p></td>
<td><p>| 5. Sending peer sent it’s possible states</p></td>
</tr>
<tr class="row-odd"><td><p>line 33</p></td>
<td><p>Remove all possible states of the sending peer from our aggregator</p></td>
</tr>
<tr class="row-even"><td><p>line 39</p></td>
<td><p>| 6. True means the new selected state was not yet in our SMA</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:EXPLOITATION*</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-8-4">
<h2>Case 8.4<a class="headerlink" href="#case-8-4" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 8.4, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
      <span class="k">if</span><span class="p">(</span><span class="n">bool</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 8.4, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>             <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>           <span class="o">+</span> <span class="s">&quot;0 &quot;</span>        <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | SMA.contains(newState) = &quot;</span>  <span class="o">+</span> <span class="n">bool</span>        <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>       <span class="o">+</span> <span class="n">count0</span>           <span class="o">+</span>
              <span class="s">&quot; | NOT INCONSISTENCY ANYMORE }&quot;</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>

          <span class="c1">//************************************************************************//</span>
          <span class="c1">//                                                                        //</span>
          <span class="c1">//  code for removal of all possible states here (see cases 8.1 and 8.2)  //</span>
          <span class="c1">//                                                                        //</span>
          <span class="c1">//************************************************************************//</span>

          <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
          <span class="kt">boolean</span> <span class="n">SMAbool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">addSMAMembership</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span> <span class="c1">// returns true if the selected state membership is added in the SMA bloom filter</span>
          <span class="k">if</span><span class="p">(</span><span class="n">SMAbool</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="c1">// Not executed in case 8.4, omitted here</span>
          <span class="p">}</span>
          <span class="k">else</span>
          <span class="p">{</span>
            <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8.4&quot;</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8.4. CURRENT STATE { &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; positiveAMD = &quot;</span>         <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>                <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
                  <span class="s">&quot; | shouldRemove = &quot;</span>      <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>              <span class="o">+</span> <span class="s">&quot; 0 &quot;</span>       <span class="o">+</span>
                  <span class="s">&quot; | purpose = &quot;</span>           <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span> <span class="s">&quot; | addSMAMembership(newState) = &quot;</span> <span class="o">+</span> <span class="n">SMAbool</span>     <span class="o">+</span>
                  <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; | OUTCOME = INCONSISTENCY }&quot;</span><span class="p">);</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">UNSUCCESSFUL</span><span class="p">;</span>
            <span class="n">ack</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><p>| 1. Peers have communicated before (start time = Big Bang)</p></td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Sending peer sends an EXPLOITATION</p></td>
</tr>
<tr class="row-odd"><td><p>line 18</p></td>
<td><p>| 4. New selected state is NOT in our aggregation</p></td>
</tr>
<tr class="row-even"><td><p>line 29</p></td>
<td><p>| 5. Sending peer sent it’s possible states</p></td>
</tr>
<tr class="row-odd"><td><p>line 33</p></td>
<td><p>Remove all possible states of the sending peer from our aggregator</p></td>
</tr>
<tr class="row-even"><td><p>line 43</p></td>
<td><p>| 6. New selected state was already in our SMA</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:EXPLOITATION*</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-8-5">
<h2>Case 8.5<a class="headerlink" href="#case-8-5" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 8.5, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
      <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kt">boolean</span> <span class="n">bool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newState</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">());</span>
      <span class="k">if</span><span class="p">(</span><span class="n">bool</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 8.5, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="kt">double</span> <span class="n">count0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span><span class="k">this</span><span class="p">.</span><span class="na">aggregates</span><span class="p">.</span><span class="na">getAggregate</span><span class="p">(</span><span class="n">AggregationFunction</span><span class="p">.</span><span class="na">COUNT</span><span class="p">);</span>

        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>            <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>          <span class="o">+</span> <span class="s">&quot;0 &quot;</span>        <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | SMA.contains(newState) = &quot;</span> <span class="o">+</span> <span class="n">bool</span>        <span class="o">+</span>
              <span class="s">&quot; | count0 = &quot;</span>       <span class="o">+</span> <span class="n">count0</span>           <span class="o">+</span>
              <span class="s">&quot; | NOT INCONSISTENCY ANYMORE }&quot;</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// Not executed in case 8.5, omitted here</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;8.5&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;8.5. CURRENT STATE { &quot;</span> <span class="o">+</span>
                <span class="s">&quot; positiveAMD = &quot;</span>         <span class="o">+</span> <span class="n">positiveAMD</span>       <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span> <span class="o">+</span>
                <span class="s">&quot; | shouldRemove = &quot;</span>      <span class="o">+</span> <span class="n">shouldRemove</span>      <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot; 0 &quot;</span>       <span class="o">+</span>
                <span class="s">&quot; | purpose = &quot;</span>           <span class="o">+</span> <span class="n">predictedOutcome</span>  <span class="o">+</span>
                <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; | NOTHING REMOVED FROM SMA }&quot;</span><span class="p">);</span>
          <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">UNSUCCESSFUL</span><span class="p">;</span>
          <span class="n">ack</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-even"><td><p>line 9</p></td>
<td><p>| 3. Sending peer sends an EXPLOITATION</p></td>
</tr>
<tr class="row-odd"><td><p>line 18</p></td>
<td><div class="line-block">
<div class="line">4. New selected state is NOT in our aggregation</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 32</p></td>
<td><p>| 5. Sending peer did NOT send it’s possible states</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:EXPLOITATION*</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-9">
<h2>Case 9<a class="headerlink" href="#case-9" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 9, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 9, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="kt">boolean</span> <span class="n">a</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="k">for</span><span class="p">(</span><span class="n">State</span> <span class="n">state</span> <span class="p">:</span> <span class="n">possibles</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">()))</span> <span class="p">{</span>
              <span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
              <span class="k">this</span><span class="p">.</span><span class="na">removeAggregationState</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
              <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
              <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">REMOVAL</span><span class="p">;</span>
              <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
              <span class="n">a</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
              <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span> <span class="s">&quot;#####################&quot;</span><span class="p">);</span>
              <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span>
          <span class="p">{</span>
            <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;9&quot;</span> <span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;9. CURRENT STATE { &quot;</span> <span class="o">+</span>
                  <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>       <span class="o">+</span> <span class="n">positiveDMA</span>       <span class="o">+</span>
                  <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>     <span class="o">+</span> <span class="s">&quot; 0 &quot;</span>             <span class="o">+</span>
                  <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span>
                  <span class="s">&quot; | NOTHING WAS REMOVED }&quot;</span><span class="p">);</span>
            <span class="p">}</span>
          <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><p>| 1. Peers have communicated before (start time = Big Bang)</p></td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-even"><td><p>line 15</p></td>
<td><div class="line-block">
<div class="line">2. No entries in the list of states that the sending peer think that we have</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 15</p></td>
<td><p>| 3. Migrated peer (inside a carrier node) sends a REMOVAL</p></td>
</tr>
<tr class="row-even"><td><p>line 18</p></td>
<td><div class="line-block">
<div class="line">4. Sending peer sent it’s possible states</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 24</p></td>
<td><p><strong>To be safe</strong>, remove all possible states of the sending peer from our
Aggregator</p></td>
</tr>
<tr class="row-even"><td><p>line 26</p></td>
<td><div class="line-block">
<div class="line"><strong>To be safe</strong>, inform the sending peer that the aggregator removed something,</div>
<div class="line">even if the sending peer has no entries for our Aggregator (i.e. posAMS is empty)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 33</p></td>
<td><div class="line-block">
<div class="line">5. Nothing was removed on our side</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:Not</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-10">
<h2>Case 10<a class="headerlink" href="#case-10" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 10, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 10, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="c1">// Not executed in case 10, omitted here</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;10&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;10. CURRENT STATE { &quot;</span> <span class="o">+</span>
                <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>       <span class="o">+</span> <span class="n">positiveDMA</span>      <span class="o">+</span>
                <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>     <span class="o">+</span> <span class="s">&quot; 0 &quot;</span>            <span class="o">+</span>
                <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span><span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span>
                <span class="s">&quot; | NOTHING WAS REMOVED }&quot;</span><span class="p">);</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-even"><td><p>line 15</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-odd"><td><p>line 15</p></td>
<td><div class="line-block">
<div class="line">3. Migrated peer (inside a carrier node) sends a REMOVAL</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 22</p></td>
<td><p>| 4. Sending peer did not send it’s possible states</p></td>
</tr>
<tr class="row-odd"><td><p>line 22</p></td>
<td><p>Nothing was removed on our side</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size:0</div>
<div class="line">purpose:Not</div>
</div>
</div></blockquote>
<p><strong>Notes</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">* shouldRemove:false</div>
<div class="line">newState = DisseminatorReport.SELECTED_STATE</div>
<div class="line">possibles = DisseminatorReport.ALL_POSSIBLE_STATES</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-11">
<h2>Case 11<a class="headerlink" href="#case-11" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// Not executed in case 11, omitted here</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 11, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 11, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;11&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;11. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span>   <span class="n">positiveDMA</span>   <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span>   <span class="n">posAMS</span><span class="p">.</span><span class="na">size</span><span class="p">()</span> <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span>
              <span class="s">&quot; | OUTCOME = INCONSISTENCY_2 }&quot;</span><span class="p">);</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">UNSUCCESSFUL</span><span class="p">;</span>
        <span class="n">ack</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 1</p></td>
<td><div class="line-block">
<div class="line">1. Peers have communicated before (start time = Big Bang)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 9</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-even"><td><p>line 15</p></td>
<td><p>| 2. No entries in the list of states that the sending peer think that we have</p></td>
</tr>
<tr class="row-odd"><td><p>line 15</p></td>
<td><div class="line-block">
<div class="line">3. Migrated peer (inside a carrier node) sends a REMOVAL</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 19</p></td>
<td><div class="line-block">
<div class="line">4. posAMS.size &gt; 1</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 27</p></td>
<td><p>Normally this should not happen, because posAMS should never be &gt;= 1</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:1</div>
<div class="line">positiveDMA:1</div>
<div class="line">posAMS.size: &gt;1</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-12">
<h2>Case 12<a class="headerlink" href="#case-12" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 12, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">possibles</span> <span class="o">=</span> <span class="p">(</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span><span class="p">)</span> <span class="n">disseminatorReport</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">DisseminatorReport</span><span class="p">.</span><span class="na">ALL_POSSIBLE_STATES</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="kt">boolean</span> <span class="n">a</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">State</span> <span class="n">state</span> <span class="p">:</span> <span class="n">possibles</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">SMA</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">getStateId</span><span class="p">().</span><span class="na">toString</span><span class="p">()))</span>
          <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">removeSMAMembership</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="na">removeAggregationState</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
            <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="n">state</span><span class="p">;</span>
            <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">REMOVAL</span><span class="p">;</span>
            <span class="n">a</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="n">System</span><span class="p">.</span><span class="na">err</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\t\t\t\t\t^&amp;*^&amp;*^&amp;*^&amp;*^&amp;*^&amp;*^&amp;*^&amp;*^&amp;*^&amp;*&quot;</span><span class="p">);</span>
            <span class="k">break</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;12&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;12. CURRENT STATE { &quot;</span> <span class="o">+</span>
                <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>       <span class="o">+</span> <span class="n">positiveDMA</span>       <span class="o">+</span>
                <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>     <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span>      <span class="o">+</span>
                <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span>
                <span class="s">&quot; | NOTHING WAS REMOVED }&quot;</span><span class="p">);</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 7</p></td>
<td><div class="line-block">
<div class="line">1. Only the receiving peer believes we have communicared before</div>
<div class="line">(typically when the sending peer never received the PUSH message)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 7</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-even"><td><p>line 18</p></td>
<td><div class="line-block">
<div class="line">2. Remove all possible states of the sending peer in the aggregator</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 20</p></td>
<td><p>| 3. Migrated peer (inside a carrier node) sends a REMOVAL</p></td>
</tr>
<tr class="row-even"><td><p>line 27</p></td>
<td><div class="line-block">
<div class="line">4. Nothing got removed</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:0</div>
<div class="line">positiveDMA:1</div>
<div class="line">purpose: REMOVAL</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-13">
<h2>Case 13<a class="headerlink" href="#case-13" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 13, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span> <span class="n">possibles</span> <span class="o">=</span> <span class="p">(</span><span class="n">HashSet</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span><span class="p">)</span> <span class="n">disseminatorReport</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">DisseminatorReport</span><span class="p">.</span><span class="na">ALL_POSSIBLE_STATES</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="n">possibles</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 13, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;13&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;13. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>       <span class="o">+</span> <span class="n">positiveDMA</span>       <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>     <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span>      <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | possibles == null ? &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="n">possibles</span><span class="o">==</span><span class="kc">null</span><span class="p">)</span> <span class="o">+</span>
              <span class="s">&quot; | NOTHING WAS REMOVED }&quot;</span><span class="p">);</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 7</p></td>
<td><div class="line-block">
<div class="line">1. Only the receiving peer believes we have communicared before</div>
<div class="line">(typically when the sending peer never received the PUSH message)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 7</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-even"><td><p>line 15</p></td>
<td><div class="line-block">
<div class="line">2. Nothing gets removed</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:0</div>
<div class="line">positiveDMA:1</div>
<div class="line">purpose: REMOVAL</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-14">
<h2>Case 14<a class="headerlink" href="#case-14" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 14, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 14, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="s">&quot;EXPLOITATION&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">predictedOutcome</span><span class="p">))</span>
        <span class="p">{</span>
          <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
          <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">;</span>
          <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

          <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;14&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;14. CURRENT STATE { &quot;</span> <span class="o">+</span>
                <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span>  <span class="o">+</span>
                <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span> <span class="o">+</span>
                <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | ack = &quot;</span>           <span class="o">+</span> <span class="n">ack</span>          <span class="o">+</span>
                <span class="s">&quot; | OUTCOME = DUPLICATE }&quot;</span><span class="p">);</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 7</p></td>
<td><div class="line-block">
<div class="line">1. Only the receiving peer believes we have communicared before</div>
<div class="line">(typically when the sending peer never received the PUSH message)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 7</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-even"><td><p>line 15</p></td>
<td><div class="line-block">
<div class="line">If the current version, where predictedOutcome can only be REMOVAL or</div>
<div class="line">EXPLOITATION, this line of code is redundant and could be removed</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 15</p></td>
<td><p>Duplicate, nothing gets changed</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:0</div>
<div class="line">positiveDMA:1</div>
<div class="line">purpose: UPDATE</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-15">
<h2>Case 15<a class="headerlink" href="#case-15" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 15, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 15, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="s">&quot;EXPLOITATION&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">predictedOutcome</span><span class="p">))</span>
        <span class="p">{</span>
          <span class="c1">// Not executed in case 15, omitted here</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">DOUBLE</span><span class="p">;</span>
          <span class="n">ack</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

          <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;15&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;15. CURRENT STATE { &quot;</span> <span class="o">+</span>
                <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span>  <span class="o">+</span>
                <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span> <span class="o">+</span>
                <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | ack = &quot;</span>           <span class="o">+</span> <span class="n">ack</span>          <span class="o">+</span>
                <span class="s">&quot; | OUTCOME = DUPLICATE }&quot;</span><span class="p">);</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 7</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-odd"><td><p>line 15</p></td>
<td><div class="line-block">
<div class="line">1. Conditions:</div>
<div class="line-block">
<div class="line">AMD = 1, DMA = 0</div>
<div class="line">AMD = 0, DMA = 0</div>
<div class="line">This can be compressed to just DMA = 0</div>
</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 19</p></td>
<td><p>Duplicate, nothing gets changed</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveAMD:0</div>
<div class="line">positiveDMA:1</div>
<div class="line">purpose: UPDATE</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-16">
<h2>Case 16<a class="headerlink" href="#case-16" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 16, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 16, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">shouldRemove</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 16, omitted here</span>
      <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;16&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;16. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span>  <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span> <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | ack = &quot;</span>           <span class="o">+</span> <span class="n">ack</span>          <span class="o">+</span>
              <span class="s">&quot; | ... }&quot;</span><span class="p">);</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 7</p></td>
<td><p>shouldRemove (REMOVAL) are only sent by migrated disseminators</p></td>
</tr>
<tr class="row-odd"><td><p>line 13</p></td>
<td><div class="line-block">
<div class="line">1. Conditions:</div>
<div class="line-block">
<div class="line">AMD = 1, DMA = 0</div>
<div class="line">AMD = 0, DMA = 0</div>
<div class="line">This can be compressed to just DMA = 0</div>
</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 17 - 25</p></td>
<td><p>Do nothing</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveDMA:0</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-17">
<h2>Case 17<a class="headerlink" href="#case-17" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 17, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 17, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">positiveDMA</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
        <span class="kt">boolean</span> <span class="n">DMAbool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">addDMAMembership</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
        <span class="kt">boolean</span> <span class="n">SMAbool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">addSMAMembership</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="n">DMAbool</span> <span class="o">&amp;&amp;</span> <span class="n">SMAbool</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="na">addAggregationState</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>
          <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">FIRST</span><span class="p">;</span>
          <span class="n">ack</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

          <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;17&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;17. CURRENT STATE { &quot;</span> <span class="o">+</span>
                <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>           <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>               <span class="o">+</span> <span class="n">positiveDMA</span>  <span class="o">+</span>
                <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>          <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>             <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span> <span class="o">+</span>
                <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span>      <span class="o">+</span> <span class="s">&quot; | addDMAMembership(newNode) = &quot;</span> <span class="o">+</span> <span class="n">DMAbool</span>      <span class="o">+</span>
                <span class="s">&quot; | addSMAMembership(newState) = &quot;</span> <span class="o">+</span> <span class="n">SMAbool</span> <span class="o">+</span> <span class="s">&quot; | ack = &quot;</span>                       <span class="o">+</span> <span class="n">ack</span>          <span class="o">+</span>
                <span class="s">&quot; | OUTCOME = EXPLOITATION }&quot;</span><span class="p">);</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 13</p></td>
<td><div class="line-block">
<div class="line">1. Peers have never communicated before</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 21</p></td>
<td><div class="line-block">
<div class="line">2. Peer and new state successfully added to the BloomFilters</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 22 - 32</p></td>
<td><p>Do nothing</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveDMA:0</div>
<div class="line">positiveAMD:0</div>
<div class="line">DMAbool:1</div>
<div class="line">SMAbool:1</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-18">
<h2>Case 18<a class="headerlink" href="#case-18" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 18, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 18, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">positiveDMA</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">AMSAddition</span> <span class="o">=</span> <span class="n">newState</span><span class="p">;</span>
        <span class="kt">boolean</span> <span class="n">DMAbool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">addDMAMembership</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
        <span class="kt">boolean</span> <span class="n">SMAbool</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">addSMAMembership</span><span class="p">(</span><span class="n">newState</span><span class="p">);</span>

        <span class="k">if</span><span class="p">(</span><span class="n">DMAbool</span> <span class="o">&amp;&amp;</span> <span class="n">SMAbool</span><span class="p">)</span>
        <span class="p">{</span>
          <span class="c1">// Not executed in case 18, omitted here</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
          <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;18&quot;</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;18. CURRENT STATE { &quot;</span> <span class="o">+</span>
                <span class="s">&quot; positiveAMD = &quot;</span>                  <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>               <span class="o">+</span> <span class="n">positiveDMA</span>  <span class="o">+</span>
                <span class="s">&quot; | shouldRemove = &quot;</span>               <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span>             <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span> <span class="o">+</span>
                <span class="s">&quot; | purpose = &quot;</span>                    <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | addDMAMembership(newNode) = &quot;</span> <span class="o">+</span> <span class="n">DMAbool</span>      <span class="o">+</span>
                <span class="s">&quot; | addSMAMembership(newState) = &quot;</span> <span class="o">+</span> <span class="n">SMAbool</span>          <span class="o">+</span> <span class="s">&quot; | ack = &quot;</span>                       <span class="o">+</span> <span class="n">ack</span>          <span class="o">+</span>
                <span class="s">&quot; | OUTCOME = INCONSISTENCY }&quot;</span><span class="p">);</span>
          <span class="n">outcome</span><span class="o">=</span><span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">UNSUCCESSFUL</span><span class="p">;</span>
          <span class="n">ack</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 13</p></td>
<td><div class="line-block">
<div class="line">1. Peers have never communicated before</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 25</p></td>
<td><div class="line-block">
<div class="line">2. Peer and/or new state not added to the Bloomfilters</div>
</div>
</td>
</tr>
<tr class="row-even"><td><p>line 26 - 33</p></td>
<td><p>Do nothing</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveDMA:0</div>
<div class="line">positiveAMD:0</div>
<div class="line">DMAbool:0 AND/OR SMAbool:0</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-19">
<h2>Case 19<a class="headerlink" href="#case-19" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positive</span> <span class="n">DMA</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 19, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="n">positiveDMA</span> <span class="o">&amp;&amp;</span> <span class="n">shouldRemove</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// Not executed in case 19, omitted here</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">positiveDMA</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="c1">// Not executed in case 19, omitted here</span>
      <span class="p">}</span>
      <span class="k">if</span><span class="p">(</span><span class="n">positiveAMD</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">positiveDMA</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;19&quot;</span> <span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;19. CURRENT STATE { &quot;</span> <span class="o">+</span>
              <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span>  <span class="o">+</span>
              <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span> <span class="o">+</span>
              <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | ack = &quot;</span>           <span class="o">+</span> <span class="n">ack</span>          <span class="o">+</span>
              <span class="s">&quot; | OUTCOME = INCONSISTENCY }&quot;</span><span class="p">);</span>
        <span class="n">outcome</span><span class="o">=</span><span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">UNSUCCESSFUL</span><span class="p">;</span>
        <span class="n">ack</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 17</p></td>
<td><div class="line-block">
<div class="line">1. Only the sending peers believes the peers have communicated before</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 19 - 26</p></td>
<td><p>Do nothing</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 1</div>
<div class="line">positiveDMA:0</div>
<div class="line">positiveAMD:1</div>
</div>
</div></blockquote>
</div>
<div class="section" id="case-20">
<h2>Case 20<a class="headerlink" href="#case-20" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">myTopic</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">otherTopic</span><span class="p">))</span>
<span class="p">{</span>
  <span class="c1">// Not executed in case 20, omitted here</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
  <span class="n">ack</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

  <span class="n">logEvent</span><span class="p">(</span> <span class="s">&quot;receiveDisseminatorReport&quot;</span><span class="p">,</span> <span class="s">&quot;case&quot;</span><span class="p">,</span> <span class="s">&quot;20&quot;</span> <span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;20. CURRENT STATE { &quot;</span> <span class="o">+</span>
        <span class="s">&quot; positiveAMD = &quot;</span>    <span class="o">+</span> <span class="n">positiveAMD</span>      <span class="o">+</span> <span class="s">&quot; | positiveDMA = &quot;</span>   <span class="o">+</span> <span class="n">positiveDMA</span>  <span class="o">+</span>
        <span class="s">&quot; | shouldRemove = &quot;</span> <span class="o">+</span> <span class="n">shouldRemove</span>     <span class="o">+</span> <span class="s">&quot; | posAMS.size() = &quot;</span> <span class="o">+</span> <span class="s">&quot;NO POS AMS&quot;</span> <span class="o">+</span>
        <span class="s">&quot; | purpose = &quot;</span>      <span class="o">+</span> <span class="n">predictedOutcome</span> <span class="o">+</span> <span class="s">&quot; | ack = &quot;</span>           <span class="o">+</span> <span class="n">ack</span>          <span class="o">+</span>
        <span class="s">&quot; | OUTCOME = INCOCNSISTENCY DUE TO TOPIC MISMATCH }&quot;</span><span class="p">);</span>
  <span class="n">outcome</span> <span class="o">=</span> <span class="n">AggregationOutcome</span><span class="p">.</span><span class="na">UNSUCCESSFUL</span><span class="p">;</span>
  <span class="n">AMSAddition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="n">AMSRemoval</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="n">aggregatorReport</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">AggregatorReport</span><span class="p">.</span><span class="na">ACK</span><span class="p">,</span> <span class="n">ack</span><span class="p">);</span>
  <span class="n">aggregatorReport</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">AggregatorReport</span><span class="p">.</span><span class="na">OUTCOME</span><span class="p">,</span> <span class="n">outcome</span><span class="p">);</span>
  <span class="n">aggregatorReport</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">AggregatorReport</span><span class="p">.</span><span class="na">AMS_ADDITION</span><span class="p">,</span> <span class="n">AMSAddition</span><span class="p">);</span>
  <span class="n">aggregatorReport</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">AggregatorReport</span><span class="p">.</span><span class="na">AMS_REMOVAL</span><span class="p">,</span> <span class="n">AMSRemoval</span><span class="p">);</span>
  <span class="n">disseminatorReport</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
  <span class="k">return</span> <span class="n">aggregatorReport</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Line number</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>line 5</p></td>
<td><div class="line-block">
<div class="line">1. Topic mismatch</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><p>line 5 - 24</p></td>
<td><p>Do nothing</p></td>
</tr>
</tbody>
</table>
<p><strong>Encoding:</strong></p>
<blockquote>
<div><div class="line-block">
<div class="line">Topic Matched = 0</div>
</div>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="change.states.html" class="btn btn-neutral float-right" title="Changing of states" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="conceptual.architecture.html" class="btn btn-neutral float-left" title="Conceptual Architecture" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Edward Gaere

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
    /*To underline text*/
    .underline {
      text-decoration: underline;
    }


      /*To underline bold text*/
      .underlinebold{
        text-decoration: underline;
        font-weight: bold;
      }

    /* Sidebar header (and topbar for mobile) */



      :root{
        --grey: rgb(231, 232, 233);
        --altblue: rgb(30,115,190);
        --blue: rgb(37, 117, 187);
      }

      /*link visited and unvisited color*/

      a {
        color: var(--grey);
        text-decoration: underline;
        cursor: pointer;
      }

      a:visited {
        color: var(--grey);
        text-decoration: underline;
        cursor: pointer;
      }

      /*footer colors*/

      footer{
        color:var(--grey)
      }

      a:hover {
        color: var(--grey);
        text-decoration: underline;
        cursor: pointer;
        text-decoration-color: var(--blue);
      }

     .wy-nav-side {

        /*background: rgb(30,115,190);*/
        background: var(--grey);
        color:/**#eee;*/var(--blue);


     }

     .wy-nav-content-wrap{
       background: var(--grey);
     }

     .wy-menu-vertical li.toctree-l1.current>a {
        color: var(--blue);
     }

     .wy-menu-vertical li.toctree-l2 a{
       color: var(--blue);
     }

     .wy-menu-vertical li.toctree-l2 a:hover{
       color: var(--grey);
       background:var(--blue);
     }

     .wy-menu-vertical li.toctree-l2.current li.toctree-l3>a:hover{
         color: var(--grey);
         background:var(--blue);
     }

     .wy-menu-vertical li.toctree-l3.current li.toctree-l4>a:hover{
           color: var(--grey);
           background:var(--blue);
     }

    .wy-side-nav-search {

        background:var(--grey); /*rgb(30,115,190);*/

    }

    .wy-menu-vertical a{
      color:var(--blue);
      text-decoration: none;
    }

    .wy-menu-vertical li.current{
        color:var(--blue);
    }

    .wy-menu-vertical li{
        color:var(--blue);
    }

    .wy-menu-vertival a:current {
      color:var(--grey);
    }

    .wy-menu-vertical a:hover{
        background-color:var(--blue);
        color:var(--grey);
    }

    .fa-home::before, .icon-home::before {
        content:"";
    }

    a.icon-home {
        width: 50%;
        margin-left: -6px;
        font-size: 0%;
        content:url("http://dias-net.org/wp-content/uploads/2016/08/silver-nodes-above-extended.png");
    }

    .wy-nav-content{
        max-width: initial;
        background:var(--blue);
        color:var(--grey);
    }

    /*nav top current directory, delete link underline*/
    .wy-breadcrumbs li a:first-child{
      text-decoration: none;
    }


    /*buton colors*/
    .btn-neutral {
        color: var(--blue) !important;
        background-color: var(--grey) !important;
    }
    .btn-neutral:visited {
        color: var(--blue) !important;
        background-color: var(--grey) !important;
    }

    /*codeblock color*/
    .rst-content div[class^='highlight'] pre{
      color:black;
      border-radius:3px; /*rounded corners*/
    }

    /*make sure tables do no have white backgrounds*/
    .rst-content table.docutils:not(.field-list) tr:nth-child(2n-1) td {
      background-color:var(--blue)
    }

    /*color of table header*/
    .rst-content table.docutils thead{
      color:var(--grey) !important;
    }

    /*table title thick border*/
    .rst-content table.docutils thead th{
      border-bottom: solid 2px;
      border-top: solid 2px;
      border-left: solid 2px;
      border-right: solid 2px;
    }

    /*code block line numbers*/
    div.linenodiv pre{
      color:var(--grey) !important;
      border-radius:0 !important;
    }

    /*codeblock grey background*/
    div.highlight pre{
      background-color:var(--grey);
    }

    /*rounded corners on images*/
    .rst-content .section>img{
      border-radius:3px;
    }

    /*rounded corners on codeblocks*/
    .rst-content div[class^='highlight']{
        border-radius:3px;
    }

  </style>


</body>
</html>